#!/usr/bin/env python3

"""
Compute state space kinematic matrices for xArm7 robot arm (5 links, 7 joints)
"""

import numpy as np
from sympy import *

class xArm7_kinematics():
    def __init__(self):

        self.l1 = 0.267
        self.l2 = 0.293
        self.l3 = 0.0525
        self.l4 = 0.3512
        self.l5 = 0.1232

        self.theta1 = 0.2225 #(rad) (=12.75deg)
        self.theta2 = 0.6646 #(rad) (=38.08deg)

        self.q1 , self.q2 , self.q3 , self.q4, self.q5, self.q6, self.q7 = symbols('q1 q2 q3 q4 q5 q6 q7')
        pass

    def compute_jacobian(self, r_joints_array):

        # A07 = self.A07()
        
        q1=(r_joints_array[0])
        q2=(r_joints_array[1])
        q3=(r_joints_array[2])
        q4=(r_joints_array[3])
        q5=(r_joints_array[4])
        q6=(r_joints_array[5])
        q7=(r_joints_array[6])


        J_11 = -0.0969785488452206*(((-np.sin(q1)*np.cos(q2)*np.cos(q3) - np.sin(q3)*np.cos(q1))*np.cos(q4) - np.sin(q1)*np.sin(q2)*np.sin(q4))*np.cos(q5) + (-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.sin(q5))*np.sin(q6) + 0.0759828998122285*(((-np.sin(q1)*np.cos(q2)*np.cos(q3) - np.sin(q3)*np.cos(q1))*np.cos(q4) - np.sin(q1)*np.sin(q2)*np.sin(q4))*np.cos(q5) + (-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.sin(q5))*np.cos(q6) + 0.0759828998122285*((-np.sin(q1)*np.cos(q2)*np.cos(q3) - np.sin(q3)*np.cos(q1))*np.sin(q4) + np.sin(q1)*np.sin(q2)*np.cos(q4))*np.sin(q6) + 0.0969785488452206*((-np.sin(q1)*np.cos(q2)*np.cos(q3) - np.sin(q3)*np.cos(q1))*np.sin(q4) + np.sin(q1)*np.sin(q2)*np.cos(q4))*np.cos(q6) + 0.34254250774854*(-np.sin(q1)*np.cos(q2)*np.cos(q3) - np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0774988411870877*(-np.sin(q1)*np.cos(q2)*np.cos(q3) - np.sin(q3)*np.cos(q1))*np.cos(q4) - 0.0774988411870877*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.34254250774854*np.sin(q1)*np.sin(q2)*np.cos(q4) - 0.293*np.sin(q1)*np.sin(q2) - 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.0525*np.sin(q3)*np.cos(q1)
        J_12 = -0.0969785488452206*((-np.sin(q2)*np.cos(q1)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q1)*np.cos(q2))*np.cos(q5) - np.sin(q2)*np.sin(q3)*np.sin(q5)*np.cos(q1))*np.sin(q6) + 0.0759828998122285*((-np.sin(q2)*np.cos(q1)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q1)*np.cos(q2))*np.cos(q5) - np.sin(q2)*np.sin(q3)*np.sin(q5)*np.cos(q1))*np.cos(q6) + 0.0759828998122285*(-np.sin(q2)*np.sin(q4)*np.cos(q1)*np.cos(q3) - np.cos(q1)*np.cos(q2)*np.cos(q4))*np.sin(q6) + 0.0969785488452206*(-np.sin(q2)*np.sin(q4)*np.cos(q1)*np.cos(q3) - np.cos(q1)*np.cos(q2)*np.cos(q4))*np.cos(q6) - 0.34254250774854*np.sin(q2)*np.sin(q4)*np.cos(q1)*np.cos(q3) - 0.0774988411870877*np.sin(q2)*np.cos(q1)*np.cos(q3)*np.cos(q4) - 0.0525*np.sin(q2)*np.cos(q1)*np.cos(q3) + 0.0774988411870877*np.sin(q4)*np.cos(q1)*np.cos(q2) - 0.34254250774854*np.cos(q1)*np.cos(q2)*np.cos(q4) + 0.293*np.cos(q1)*np.cos(q2)
        J_13 = -0.0969785488452206*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q5) + (-np.sin(q1)*np.cos(q3) - np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q4)*np.cos(q5))*np.sin(q6) + 0.0759828998122285*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q5) + (-np.sin(q1)*np.cos(q3) - np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q4)*np.cos(q5))*np.cos(q6) + 0.0759828998122285*(-np.sin(q1)*np.cos(q3) - np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q4)*np.sin(q6) + 0.0969785488452206*(-np.sin(q1)*np.cos(q3) - np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q4)*np.cos(q6) + 0.34254250774854*(-np.sin(q1)*np.cos(q3) - np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q4) + 0.0774988411870877*(-np.sin(q1)*np.cos(q3) - np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q4) - 0.0525*np.sin(q1)*np.cos(q3) - 0.0525*np.sin(q3)*np.cos(q1)*np.cos(q2)

        J_14 = -0.0969785488452206*(-(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + np.sin(q2)*np.cos(q1)*np.cos(q4))*np.sin(q6)*np.cos(q5) + 0.0759828998122285*(-(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + np.sin(q2)*np.cos(q1)*np.cos(q4))*np.cos(q5)*np.cos(q6) + 0.0759828998122285*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.sin(q6) + 0.0969785488452206*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.cos(q6) - 0.0774988411870877*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.34254250774854*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + 0.34254250774854*np.sin(q2)*np.sin(q4)*np.cos(q1) + 0.0774988411870877*np.sin(q2)*np.cos(q1)*np.cos(q4)

        J_15 = -0.0969785488452206*(-((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.sin(q5) + (np.sin(q1)*np.cos(q3) + np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q5))*np.sin(q6) + 0.0759828998122285*(-((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.sin(q5) + (np.sin(q1)*np.cos(q3) + np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q5))*np.cos(q6)

        J_16 = -0.0759828998122285*(((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.cos(q5) + (np.sin(q1)*np.cos(q3) + np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q5))*np.sin(q6) - 0.0969785488452206*(((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.cos(q5) + (np.sin(q1)*np.cos(q3) + np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q5))*np.cos(q6) - 0.0969785488452206*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) - np.sin(q2)*np.cos(q1)*np.cos(q4))*np.sin(q6) + 0.0759828998122285*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) - np.sin(q2)*np.cos(q1)*np.cos(q4))*np.cos(q6)

        J_17 = 0

        J_21 = -0.0969785488452206*(((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.cos(q5) + (np.sin(q1)*np.cos(q3) + np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q5))*np.sin(q6) + 0.0759828998122285*(((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + np.sin(q2)*np.sin(q4)*np.cos(q1))*np.cos(q5) + (np.sin(q1)*np.cos(q3) + np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q5))*np.cos(q6) + 0.0759828998122285*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) - np.sin(q2)*np.cos(q1)*np.cos(q4))*np.sin(q6) + 0.0969785488452206*((-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) - np.sin(q2)*np.cos(q1)*np.cos(q4))*np.cos(q6) + 0.34254250774854*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.0774988411870877*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.0525*np.sin(q1)*np.sin(q3) + 0.0774988411870877*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.34254250774854*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.293*np.sin(q2)*np.cos(q1) + 0.0525*np.cos(q1)*np.cos(q2)*np.cos(q3)
        J_22 = -0.0969785488452206*((-np.sin(q1)*np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q1)*np.sin(q4)*np.cos(q2))*np.cos(q5) - np.sin(q1)*np.sin(q2)*np.sin(q3)*np.sin(q5))*np.sin(q6) + 0.0759828998122285*((-np.sin(q1)*np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q1)*np.sin(q4)*np.cos(q2))*np.cos(q5) - np.sin(q1)*np.sin(q2)*np.sin(q3)*np.sin(q5))*np.cos(q6) + 0.0759828998122285*(-np.sin(q1)*np.sin(q2)*np.sin(q4)*np.cos(q3) - np.sin(q1)*np.cos(q2)*np.cos(q4))*np.sin(q6) + 0.0969785488452206*(-np.sin(q1)*np.sin(q2)*np.sin(q4)*np.cos(q3) - np.sin(q1)*np.cos(q2)*np.cos(q4))*np.cos(q6) - 0.34254250774854*np.sin(q1)*np.sin(q2)*np.sin(q4)*np.cos(q3) - 0.0774988411870877*np.sin(q1)*np.sin(q2)*np.cos(q3)*np.cos(q4) - 0.0525*np.sin(q1)*np.sin(q2)*np.cos(q3) + 0.0774988411870877*np.sin(q1)*np.sin(q4)*np.cos(q2) - 0.34254250774854*np.sin(q1)*np.cos(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.cos(q2)
        J_23 = -0.0969785488452206*((-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.cos(q4)*np.cos(q5) + (np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q5))*np.sin(q6) + 0.0759828998122285*((-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.cos(q4)*np.cos(q5) + (np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q5))*np.cos(q6) + 0.0759828998122285*(-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.sin(q4)*np.sin(q6) + 0.0969785488452206*(-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.sin(q4)*np.cos(q6) + 0.34254250774854*(-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.sin(q4) + 0.0774988411870877*(-np.sin(q1)*np.sin(q3)*np.cos(q2) + np.cos(q1)*np.cos(q3))*np.cos(q4) - 0.0525*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.cos(q1)*np.cos(q3)
        J_24 = -0.0969785488452206*(-(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + np.sin(q1)*np.sin(q2)*np.cos(q4))*np.sin(q6)*np.cos(q5) + 0.0759828998122285*(-(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + np.sin(q1)*np.sin(q2)*np.cos(q4))*np.cos(q5)*np.cos(q6) + 0.0759828998122285*((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + np.sin(q1)*np.sin(q2)*np.sin(q4))*np.sin(q6) + 0.0969785488452206*((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + np.sin(q1)*np.sin(q2)*np.sin(q4))*np.cos(q6) - 0.0774988411870877*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.34254250774854*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.34254250774854*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.0774988411870877*np.sin(q1)*np.sin(q2)*np.cos(q4)
        J_25 = -0.0969785488452206*(-((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + np.sin(q1)*np.sin(q2)*np.sin(q4))*np.sin(q5) + (np.sin(q1)*np.sin(q3)*np.cos(q2) - np.cos(q1)*np.cos(q3))*np.cos(q5))*np.sin(q6) + 0.0759828998122285*(-((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + np.sin(q1)*np.sin(q2)*np.sin(q4))*np.sin(q5) + (np.sin(q1)*np.sin(q3)*np.cos(q2) - np.cos(q1)*np.cos(q3))*np.cos(q5))*np.cos(q6)
        J_26 = -0.0759828998122285*(((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + np.sin(q1)*np.sin(q2)*np.sin(q4))*np.cos(q5) + (np.sin(q1)*np.sin(q3)*np.cos(q2) - np.cos(q1)*np.cos(q3))*np.sin(q5))*np.sin(q6) - 0.0969785488452206*(((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + np.sin(q1)*np.sin(q2)*np.sin(q4))*np.cos(q5) + (np.sin(q1)*np.sin(q3)*np.cos(q2) - np.cos(q1)*np.cos(q3))*np.sin(q5))*np.cos(q6) - 0.0969785488452206*((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) - np.sin(q1)*np.sin(q2)*np.cos(q4))*np.sin(q6) + 0.0759828998122285*((np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) - np.sin(q1)*np.sin(q2)*np.cos(q4))*np.cos(q6)
        J_27 = 0

        J_31 = 0

        J_32 = -0.0969785488452206*((-np.sin(q2)*np.sin(q4) - np.cos(q2)*np.cos(q3)*np.cos(q4))*np.cos(q5) - np.sin(q3)*np.sin(q5)*np.cos(q2))*np.sin(q6) + 0.0759828998122285*((-np.sin(q2)*np.sin(q4) - np.cos(q2)*np.cos(q3)*np.cos(q4))*np.cos(q5) - np.sin(q3)*np.sin(q5)*np.cos(q2))*np.cos(q6) + 0.0759828998122285*(np.sin(q2)*np.cos(q4) - np.sin(q4)*np.cos(q2)*np.cos(q3))*np.sin(q6) + 0.0969785488452206*(np.sin(q2)*np.cos(q4) - np.sin(q4)*np.cos(q2)*np.cos(q3))*np.cos(q6) - 0.0774988411870877*np.sin(q2)*np.sin(q4) + 0.34254250774854*np.sin(q2)*np.cos(q4) - 0.293*np.sin(q2) - 0.34254250774854*np.sin(q4)*np.cos(q2)*np.cos(q3) - 0.0774988411870877*np.cos(q2)*np.cos(q3)*np.cos(q4) - 0.0525*np.cos(q2)*np.cos(q3)
        J_33 = -0.0969785488452206*(np.sin(q2)*np.sin(q3)*np.cos(q4)*np.cos(q5) - np.sin(q2)*np.sin(q5)*np.cos(q3))*np.sin(q6) + 0.0759828998122285*(np.sin(q2)*np.sin(q3)*np.cos(q4)*np.cos(q5) - np.sin(q2)*np.sin(q5)*np.cos(q3))*np.cos(q6) + 0.0759828998122285*np.sin(q2)*np.sin(q3)*np.sin(q4)*np.sin(q6) + 0.0969785488452206*np.sin(q2)*np.sin(q3)*np.sin(q4)*np.cos(q6) + 0.34254250774854*np.sin(q2)*np.sin(q3)*np.sin(q4) + 0.0774988411870877*np.sin(q2)*np.sin(q3)*np.cos(q4) + 0.0525*np.sin(q2)*np.sin(q3)
        J_34 = -0.0969785488452206*(np.sin(q2)*np.sin(q4)*np.cos(q3) + np.cos(q2)*np.cos(q4))*np.sin(q6)*np.cos(q5) + 0.0759828998122285*(np.sin(q2)*np.sin(q4)*np.cos(q3) + np.cos(q2)*np.cos(q4))*np.cos(q5)*np.cos(q6) + 0.0759828998122285*(-np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q2))*np.sin(q6) + 0.0969785488452206*(-np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q2))*np.cos(q6) + 0.0774988411870877*np.sin(q2)*np.sin(q4)*np.cos(q3) - 0.34254250774854*np.sin(q2)*np.cos(q3)*np.cos(q4) + 0.34254250774854*np.sin(q4)*np.cos(q2) + 0.0774988411870877*np.cos(q2)*np.cos(q4)
        J_35 = -0.0969785488452206*(-(-np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q2))*np.sin(q5) - np.sin(q2)*np.sin(q3)*np.cos(q5))*np.sin(q6) + 0.0759828998122285*(-(-np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q2))*np.sin(q5) - np.sin(q2)*np.sin(q3)*np.cos(q5))*np.cos(q6)
        J_36 = -0.0759828998122285*((-np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q2))*np.cos(q5) - np.sin(q2)*np.sin(q3)*np.sin(q5))*np.sin(q6) - 0.0969785488452206*((-np.sin(q2)*np.cos(q3)*np.cos(q4) + np.sin(q4)*np.cos(q2))*np.cos(q5) - np.sin(q2)*np.sin(q3)*np.sin(q5))*np.cos(q6) - 0.0969785488452206*(-np.sin(q2)*np.sin(q4)*np.cos(q3) - np.cos(q2)*np.cos(q4))*np.sin(q6) + 0.0759828998122285*(-np.sin(q2)*np.sin(q4)*np.cos(q3) - np.cos(q2)*np.cos(q4))*np.cos(q6)
        J_37 = 0

        J = np.matrix([ [ J_11 , J_12 , J_13 , J_14 , J_15 , J_16 , J_17 ],\
                        [ J_21 , J_22 , J_23 , J_24 , J_25 , J_26 , J_27 ],\
                        [ J_31 , J_32 , J_33 , J_34 , J_35 , J_36 , J_37 ]],dtype = 'float')
        return J

    def tf_A01(self, r_joints_array):
        q1 = (r_joints_array[0])
        tf = np.matrix([[np.cos(q1) , -np.sin(q1) , 0 , 0],\
                        [np.sin(q1) , np.cos(q1) , 0 , 0],\
                        [0 , 0 , 1 , self.l1],\
                        [0 , 0 , 0 , 1]])
        return tf

    def tf_A02(self, r_joints_array):
        q2 = (r_joints_array[1])
        tf_A12 = np.matrix([[np.cos(q2),-np.sin(q2),0,0],\
                            [0,0,1,0],\
                            [-np.sin(q2),-np.cos(q2),0,0],\
                            [0,0,0,1]])
        tf = np.dot( self.tf_A01(r_joints_array), tf_A12 )
        return tf

    def tf_A03(self, r_joints_array):
        q3 = (r_joints_array[2])
        tf_A23 = np.matrix([[np.cos(q3),-np.sin(q3),0,0],\
                            [0,0,-1,-self.l2],\
                            [np.sin(q3),np.cos(q3),0,0],\
                            [0,0,0,1]])

        tf = np.dot( self.tf_A02(r_joints_array), tf_A23 )
        return tf

    def tf_A04(self, r_joints_array):
        q4 = (r_joints_array[3])
        tf_A34 = np.matrix([[np.cos(q4),-np.sin(q4),0,self.l3],\
                            [0,0,-1,0],\
                            [np.sin(q4),np.cos(q4),0,0],\
                            [0,0,0,1]])
        tf = np.dot( self.tf_A03(r_joints_array), tf_A34 )
        return tf

    def tf_A05(self, r_joints_array):
        q5 = (r_joints_array[4])
        tf_A45 = np.matrix([[np.cos(q5),-np.sin(q5),0,self.l4*np.sin(self.theta1)],\
                            [0,0,-1,-self.l4*np.cos(self.theta1)],\
                            [np.sin(q5),np.cos(q5),0,0],\
                            [0,0,0,1]])

        tf = np.dot( self.tf_A04(r_joints_array), tf_A45 )
        return tf

    def tf_A06(self, r_joints_array):
        q6 = (r_joints_array[5])
        tf_A56 = np.matrix([[np.cos(q6),-np.sin(q6),0,0],\
                            [0,0,-1,0],\
                            [np.sin(q6),np.cos(q6),0,0],\
                            [0,0,0,1]])

        tf = np.dot( self.tf_A05(r_joints_array), tf_A56 )
        return tf

    def tf_A07(self, r_joints_array):
        q7 = (r_joints_array[6])
        tf_A67 = np.matrix([[np.cos(q7),-np.sin(q7),0,self.l5*np.sin(self.theta2)],\
                            [0,0,1,self.l5*np.cos(self.theta2)],\
                            [-np.sin(q7),-np.cos(q7),0,0],\
                            [0,0,0,1]])
        tf = np.dot( self.tf_A06(r_joints_array), tf_A67 )
        return tf

    def tf_A04A(self,r_joints_array):
        tf_44A = np.matrix([[1,0,0,0],\
                            [0,1,0,0],\
                            [0,0,1,-0.069],\
                            [0,0,0,1]])
        tf = np.dot(self.tf_A04(r_joints_array),tf_44A)
        return tf

    def tf_A04B(self,r_joints_array):
        tf_44B = np.matrix([[1,0,0,0],\
                            [0,1,0,0],\
                            [0,0,1,0.10688],\
                            [0,0,0,1]])
        tf = np.dot(self.tf_A04(r_joints_array),tf_44B)
        return tf
    
    def tf_A04C(self,r_joints_array):
        tf_4B4C = np.matrix([[np.cos(-np.pi/4),np.sin(-np.pi/4),0,np.cos(-np.pi/4)*(0.126/2)],\
                            [np.sin(-np.pi/4),np.cos(-np.pi/4),0,np.sin(-np.pi/4)*(0.126/2)],\
                            [0,0,1,0],\
                            [0,0,0,1]])
        tf = np.dot(self.tf_A04B(r_joints_array),tf_4B4C)
        return tf

    def tf_A04D(self,r_joints_array):
        tf_4C4D = np.matrix([[np.cos(-np.pi/4),np.sin(-np.pi/4),0,np.cos(-np.pi/4)*(0.126)],\
                            [np.sin(-np.pi/4),np.cos(-np.pi/4),0,np.sin(-np.pi/4)*(0.126)],\
                            [0,0,1,0],\
                            [0,0,0,1]])
        tf = np.dot(self.tf_A04C(r_joints_array),tf_4C4D)
        return tf

    def tf_A04E(self,r_joints_array):
        tf_4D4E = np.matrix([[1,0,0,0],\
                            [0,1,0,0],\
                            [0,0,1,-0.10688-0.042],\
                            [0,0,0,1]])
        tf = np.dot(self.tf_A04D(r_joints_array),tf_4D4E)
        return tf
    
    def tf_A04F(self,r_joints_array):
        tf_4E4F = np.matrix([[np.cos(np.pi/4) ,np.sin(np.pi/4) , 0 ,np.cos(np.pi/4)*(0.126/2)],\
                            [-np.sin(np.pi/4) ,np.cos(np.pi/4) , 0 , -np.sin(np.pi/4)*(0.126/2)],\
                            [0 , 0 , 1 , -0.069/2],\
                            [0 , 0 , 0 , 1]])
        tf = np.dot( self.tf_A04(r_joints_array), tf_4E4F )
        return tf

    def A01_tf(self):
        q1 = symbols('q1')
        tf =Matrix([[cos(q1), -sin(q1), 0, 0],\
                    [sin(q1),cos(q1),0,0],\
                    [0,0,1,self.l1],\
                    [0,0,0,1]])
        return tf

    def A02_tf(self):
        q2 = symbols('q2')
        A12=Matrix([[cos(q2),-sin(q2),0,0],\
                    [0,0,1,0],\
                    [-sin(q2),-cos(q2),0,0],\
                    [0,0,0,1]])
        tf = self.A01_tf()*A12 
        return tf

    def A03_tf(self):
        q3 = symbols('q3')
        A23=Matrix([[cos(q3),-sin(q3),0,0],\
                    [0,0,-1,-self.l2],\
                    [sin(q3),cos(q3),0,0],\
                    [0,0,0,1]])

        tf =self.A02_tf()*A23
        return tf

    def A04_tf(self):
        q4 = symbols('q4')
        A34=Matrix([[cos(q4),-sin(q4),0,self.l3],\
                    [0,0,-1,0],\
                    [sin(q4),cos(q4),0,0],\
                    [0,0,0,1]])

        tf = self.A03_tf()*A34
        return tf

    def A05_tf(self):
        q5 = symbols('q5')
        A45=Matrix([[cos(q5),-sin(q5),0,self.l4*sin(self.theta1)],\
                    [0,0,-1,-self.l4*np.cos(self.theta1)],\
                    [sin(q5),cos(q5),0,0],\
                    [0,0,0,1]])

        tf =self.A04_tf()*A45
        return tf

    def A06_tf(self):
        q6 = symbols('q6')
        A56=Matrix([[cos(q6),-sin(q6),0,0],\
                    [0,0,-1,0],\
                    [sin(q6),cos(q6),0,0],\
                    [0,0,0,1]])

        tf =self.A05_tf()*A56
        return tf

    def A07_tf(self):
        q7 = symbols('q7')
        A67=Matrix([[cos(q7),-sin(q7),0,self.l5*sin(self.theta2)],\
                    [0,0,1,self.l5*np.cos(self.theta2)],\
                    [-sin(q7),-cos(q7),0,0],\
                    [0,0,0,1]])
        tf =self.A06_tf()* A67
        return tf
    
    def A04A_tf(self):
        s44A_tf= np.matrix([[1,0,0,0],\
                            [0,1,0,0],\
                            [0,0,1,-0.072],\
                            [0,0,0,1]])
        tf = self.A04_tf()*s44A_tf
        return tf

    def A04B_tf(self):
        s44B_tf= np.matrix([[np.cos(np.pi/4),np.sin(np.pi/4),0,0],\
                            [-np.sin(np.pi/4),np.cos(np.pi/4),0,0],\
                            [0,0,1,0.10688],\
                            [0,0,0,1]])
        tf = self.A04_tf()*s44B_tf
        return tf
    
    def A04C_tf(self):
        s4B4C_tf = np.matrix([[1,0,0,0.126/2],\
                            [0,1,0,0],\
                            [0,0,1,0],\
                            [0,0,0,1]])
        tf = self.A04B_tf()*s4B4C_tf
        return tf

    def A04D_tf(self):
        s4C4D_tf = np.matrix([[1,0,0,0.126/2],\
                            [0,1,0,0],\
                            [0,0,1,0],\
                            [0,0,0,1]])
        tf = self.A04C_tf()*s4C4D_tf
        return tf

    def A04E_tf(self):
        s4D4E_tf = np.matrix([[1,0,0,0],\
                            [0,1,0,0],\
                            [0,0,1,-0.10688-0.052],\
                            [0,0,0,1]])
        tf = self.A04D_tf()*s4D4E_tf
        return tf

    

    def  pointA_fun(self,r_joints_array,obs_x,obs_y):
        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]

        dV1 = ((-0.586*sin(q1)*sin(q2) + 0.138*sin(q1)*sin(q3)*cos(q2) - 0.105*sin(q1)*cos(q2)*cos(q3) - 0.105*sin(q3)*cos(q1) - 0.138*cos(q1)*cos(q3))*(-obs_x - 0.0525*sin(q1)*sin(q3) - 0.069*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) - 0.069*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (-0.105*sin(q1)*sin(q3) - 0.138*sin(q1)*cos(q3) + 0.586*sin(q2)*cos(q1) - 0.138*sin(q3)*cos(q1)*cos(q2) + 0.105*cos(q1)*cos(q2)*cos(q3))*(-obs_y + 0.293*sin(q1)*sin(q2) - 0.069*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.069*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.0525*sin(q1)*sin(q3) - 0.069*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) - 0.069*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y + 0.293*sin(q1)*sin(q2) - 0.069*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.069*cos(q1)*cos(q3))**2) 
        dV2 = ((0.138*sin(q1)*sin(q2)*sin(q3) - 0.105*sin(q1)*sin(q2)*cos(q3) + 0.586*sin(q1)*cos(q2))*(-obs_y + 0.293*sin(q1)*sin(q2) - 0.069*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.069*cos(q1)*cos(q3))/2 + (0.138*sin(q2)*sin(q3)*cos(q1) - 0.105*sin(q2)*cos(q1)*cos(q3) + 0.586*cos(q1)*cos(q2))*(-obs_x - 0.0525*sin(q1)*sin(q3) - 0.069*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) - 0.069*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.0525*sin(q1)*sin(q3) - 0.069*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) - 0.069*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y + 0.293*sin(q1)*sin(q2) - 0.069*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.069*cos(q1)*cos(q3))**2) 
        dV3 = ((0.138*sin(q1)*sin(q3) - 0.105*sin(q1)*cos(q3) - 0.105*sin(q3)*cos(q1)*cos(q2) - 0.138*cos(q1)*cos(q2)*cos(q3))*(-obs_x - 0.0525*sin(q1)*sin(q3) - 0.069*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) - 0.069*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (-0.105*sin(q1)*sin(q3)*cos(q2) - 0.138*sin(q1)*cos(q2)*cos(q3) - 0.138*sin(q3)*cos(q1) + 0.105*cos(q1)*cos(q3))*(-obs_y + 0.293*sin(q1)*sin(q2) - 0.069*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.069*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.0525*sin(q1)*sin(q3) - 0.069*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) - 0.069*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y + 0.293*sin(q1)*sin(q2) - 0.069*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.069*cos(q1)*cos(q3))**2) 

        return np.array([dV1,dV2,dV3,0,0,0,0],dtype='float')

    
    def  pointB_fun(self,r_joints_array,obs_x,obs_y):
        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]

        dV1 = ((-0.586*sin(q1)*sin(q2) - 0.21376*sin(q1)*sin(q3)*cos(q2) - 0.105*sin(q1)*cos(q2)*cos(q3) - 0.105*sin(q3)*cos(q1) + 0.21376*cos(q1)*cos(q3))*(-obs_x - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (-0.105*sin(q1)*sin(q3) + 0.21376*sin(q1)*cos(q3) + 0.586*sin(q2)*cos(q1) + 0.21376*sin(q3)*cos(q1)*cos(q2) + 0.105*cos(q1)*cos(q2)*cos(q3))*(-obs_y + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        dV2 = ((-0.21376*sin(q1)*sin(q2)*sin(q3) - 0.105*sin(q1)*sin(q2)*cos(q3) + 0.586*sin(q1)*cos(q2))*(-obs_y + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2 + (-0.21376*sin(q2)*sin(q3)*cos(q1) - 0.105*sin(q2)*cos(q1)*cos(q3) + 0.586*cos(q1)*cos(q2))*(-obs_x - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2)  
        dV3 = ((-0.21376*sin(q1)*sin(q3) - 0.105*sin(q1)*cos(q3) - 0.105*sin(q3)*cos(q1)*cos(q2) + 0.21376*cos(q1)*cos(q2)*cos(q3))*(-obs_x - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (-0.105*sin(q1)*sin(q3)*cos(q2) + 0.21376*sin(q1)*cos(q2)*cos(q3) + 0.21376*sin(q3)*cos(q1) + 0.105*cos(q1)*cos(q3))*(-obs_y + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        
        return np.array([dV1,dV2,dV3,0,0,0,0],dtype='float')

    def  pointC_fun(self,r_joints_array,obs_x,obs_y):
        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]

        dV1 = ((2*(-0.0445477272147525*sin(q1)*sin(q3) + 0.0445477272147525*cos(q1)*cos(q2)*cos(q3))*cos(q4) + 2*(0.0445477272147525*sin(q1)*sin(q3) - 0.0445477272147525*cos(q1)*cos(q2)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3) + 0.21376*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.586*sin(q2)*cos(q1) + 0.21376*sin(q3)*cos(q1)*cos(q2) + 0.105*cos(q1)*cos(q2)*cos(q3))*(-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2 + (2*(-0.0445477272147525*sin(q1)*cos(q2)*cos(q3) - 0.0445477272147525*sin(q3)*cos(q1))*cos(q4) + 2*(0.0445477272147525*sin(q1)*cos(q2)*cos(q3) + 0.0445477272147525*sin(q3)*cos(q1))*sin(q4) - 0.089095454429505*sin(q1)*sin(q2)*sin(q4) - 0.089095454429505*sin(q1)*sin(q2)*cos(q4) - 0.586*sin(q1)*sin(q2) - 0.21376*sin(q1)*sin(q3)*cos(q2) - 0.105*sin(q1)*cos(q2)*cos(q3) - 0.105*sin(q3)*cos(q1) + 0.21376*cos(q1)*cos(q3))*(-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        dV2 = ((-0.21376*sin(q1)*sin(q2)*sin(q3) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4)*cos(q3) - 0.089095454429505*sin(q1)*sin(q2)*cos(q3)*cos(q4) - 0.105*sin(q1)*sin(q2)*cos(q3) + 0.089095454429505*sin(q1)*sin(q4)*cos(q2) + 0.089095454429505*sin(q1)*cos(q2)*cos(q4) + 0.586*sin(q1)*cos(q2))*(-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2 + (-0.21376*sin(q2)*sin(q3)*cos(q1) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1)*cos(q3) - 0.089095454429505*sin(q2)*cos(q1)*cos(q3)*cos(q4) - 0.105*sin(q2)*cos(q1)*cos(q3) + 0.089095454429505*sin(q4)*cos(q1)*cos(q2) + 0.089095454429505*cos(q1)*cos(q2)*cos(q4) + 0.586*cos(q1)*cos(q2))*(-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        dV3 = ((2*(-0.0445477272147525*sin(q1)*cos(q3) - 0.0445477272147525*sin(q3)*cos(q1)*cos(q2))*cos(q4) + 2*(0.0445477272147525*sin(q1)*cos(q3) + 0.0445477272147525*sin(q3)*cos(q1)*cos(q2))*sin(q4) - 0.21376*sin(q1)*sin(q3) - 0.105*sin(q1)*cos(q3) - 0.105*sin(q3)*cos(q1)*cos(q2) + 0.21376*cos(q1)*cos(q2)*cos(q3))*(-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.0445477272147525*sin(q1)*sin(q3)*cos(q2) + 0.0445477272147525*cos(q1)*cos(q3))*cos(q4) + 2*(0.0445477272147525*sin(q1)*sin(q3)*cos(q2) - 0.0445477272147525*cos(q1)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3)*cos(q2) + 0.21376*sin(q1)*cos(q2)*cos(q3) + 0.21376*sin(q3)*cos(q1) + 0.105*cos(q1)*cos(q3))*(-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        dV4 = ((-2*(-0.0445477272147525*sin(q1)*sin(q3) + 0.0445477272147525*cos(q1)*cos(q2)*cos(q3))*sin(q4) + 2*(0.0445477272147525*sin(q1)*sin(q3) - 0.0445477272147525*cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4))*(-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.0445477272147525*sin(q1)*cos(q2)*cos(q3) - 0.0445477272147525*sin(q3)*cos(q1))*cos(q4) - 2*(0.0445477272147525*sin(q1)*cos(q2)*cos(q3) + 0.0445477272147525*sin(q3)*cos(q1))*sin(q4) - 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4))*(-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.0445477272147525*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.0445477272147525*sin(q2)*sin(q4)*cos(q1) + 0.0445477272147525*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.0445477272147525*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.0445477272147525*sin(q1)*sin(q2)*sin(q4) + 0.0445477272147525*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        
        return np.array([dV1,dV2,dV3,dV4,0,0,0],dtype='float')

    def  pointD_fun(self,r_joints_array,obs_x,obs_y):
        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]

        dV1 = ((2*(-0.089095454429505*sin(q1)*sin(q3) + 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*cos(q4) + 2*(0.089095454429505*sin(q1)*sin(q3) - 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3) + 0.21376*sin(q1)*cos(q3) + 0.17819090885901*sin(q2)*sin(q4)*cos(q1) + 0.17819090885901*sin(q2)*cos(q1)*cos(q4) + 0.586*sin(q2)*cos(q1) + 0.21376*sin(q3)*cos(q1)*cos(q2) + 0.105*cos(q1)*cos(q2)*cos(q3))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2 + (2*(-0.089095454429505*sin(q1)*cos(q2)*cos(q3) - 0.089095454429505*sin(q3)*cos(q1))*cos(q4) + 2*(0.089095454429505*sin(q1)*cos(q2)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1))*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*cos(q4) - 0.586*sin(q1)*sin(q2) - 0.21376*sin(q1)*sin(q3)*cos(q2) - 0.105*sin(q1)*cos(q2)*cos(q3) - 0.105*sin(q3)*cos(q1) + 0.21376*cos(q1)*cos(q3))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        dV2 = ((-0.21376*sin(q1)*sin(q2)*sin(q3) + 0.17819090885901*sin(q1)*sin(q2)*sin(q4)*cos(q3) - 0.17819090885901*sin(q1)*sin(q2)*cos(q3)*cos(q4) - 0.105*sin(q1)*sin(q2)*cos(q3) + 0.17819090885901*sin(q1)*sin(q4)*cos(q2) + 0.17819090885901*sin(q1)*cos(q2)*cos(q4) + 0.586*sin(q1)*cos(q2))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2 + (-0.21376*sin(q2)*sin(q3)*cos(q1) + 0.17819090885901*sin(q2)*sin(q4)*cos(q1)*cos(q3) - 0.17819090885901*sin(q2)*cos(q1)*cos(q3)*cos(q4) - 0.105*sin(q2)*cos(q1)*cos(q3) + 0.17819090885901*sin(q4)*cos(q1)*cos(q2) + 0.17819090885901*cos(q1)*cos(q2)*cos(q4) + 0.586*cos(q1)*cos(q2))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        dV3 = ((2*(-0.089095454429505*sin(q1)*cos(q3) - 0.089095454429505*sin(q3)*cos(q1)*cos(q2))*cos(q4) + 2*(0.089095454429505*sin(q1)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1)*cos(q2))*sin(q4) - 0.21376*sin(q1)*sin(q3) - 0.105*sin(q1)*cos(q3) - 0.105*sin(q3)*cos(q1)*cos(q2) + 0.21376*cos(q1)*cos(q2)*cos(q3))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.089095454429505*sin(q1)*sin(q3)*cos(q2) + 0.089095454429505*cos(q1)*cos(q3))*cos(q4) + 2*(0.089095454429505*sin(q1)*sin(q3)*cos(q2) - 0.089095454429505*cos(q1)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3)*cos(q2) + 0.21376*sin(q1)*cos(q2)*cos(q3) + 0.21376*sin(q3)*cos(q1) + 0.105*cos(q1)*cos(q3))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 
        dV4 = ((-2*(-0.089095454429505*sin(q1)*sin(q3) + 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*sin(q4) + 2*(0.089095454429505*sin(q1)*sin(q3) - 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.17819090885901*sin(q2)*sin(q4)*cos(q1) + 0.17819090885901*sin(q2)*cos(q1)*cos(q4))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.089095454429505*sin(q1)*cos(q2)*cos(q3) - 0.089095454429505*sin(q3)*cos(q1))*cos(q4) - 2*(0.089095454429505*sin(q1)*cos(q2)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1))*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*sin(q4) + 0.17819090885901*sin(q1)*sin(q2)*cos(q4))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) + 0.10688*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) + 0.10688*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) + 0.10688*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) - 0.10688*cos(q1)*cos(q3))**2) 

        return np.array([dV1,dV2,dV3,dV4,0,0,0],dtype='float')

    def  pointE_fun(self,r_joints_array,obs_x,obs_y):
        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]

        dV1 = ((2*(-0.089095454429505*sin(q1)*sin(q3) + 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*cos(q4) + 2*(0.089095454429505*sin(q1)*sin(q3) - 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3) - 0.084*sin(q1)*cos(q3) + 0.17819090885901*sin(q2)*sin(q4)*cos(q1) + 0.17819090885901*sin(q2)*cos(q1)*cos(q4) + 0.586*sin(q2)*cos(q1) - 0.084*sin(q3)*cos(q1)*cos(q2) + 0.105*cos(q1)*cos(q2)*cos(q3))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2 + (2*(-0.089095454429505*sin(q1)*cos(q2)*cos(q3) - 0.089095454429505*sin(q3)*cos(q1))*cos(q4) + 2*(0.089095454429505*sin(q1)*cos(q2)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1))*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*cos(q4) - 0.586*sin(q1)*sin(q2) + 0.084*sin(q1)*sin(q3)*cos(q2) - 0.105*sin(q1)*cos(q2)*cos(q3) - 0.105*sin(q3)*cos(q1) - 0.084*cos(q1)*cos(q3))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 
        dV2 = ((0.084*sin(q1)*sin(q2)*sin(q3) + 0.17819090885901*sin(q1)*sin(q2)*sin(q4)*cos(q3) - 0.17819090885901*sin(q1)*sin(q2)*cos(q3)*cos(q4) - 0.105*sin(q1)*sin(q2)*cos(q3) + 0.17819090885901*sin(q1)*sin(q4)*cos(q2) + 0.17819090885901*sin(q1)*cos(q2)*cos(q4) + 0.586*sin(q1)*cos(q2))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2 + (0.084*sin(q2)*sin(q3)*cos(q1) + 0.17819090885901*sin(q2)*sin(q4)*cos(q1)*cos(q3) - 0.17819090885901*sin(q2)*cos(q1)*cos(q3)*cos(q4) - 0.105*sin(q2)*cos(q1)*cos(q3) + 0.17819090885901*sin(q4)*cos(q1)*cos(q2) + 0.17819090885901*cos(q1)*cos(q2)*cos(q4) + 0.586*cos(q1)*cos(q2))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 
        dV3 = ((2*(-0.089095454429505*sin(q1)*cos(q3) - 0.089095454429505*sin(q3)*cos(q1)*cos(q2))*cos(q4) + 2*(0.089095454429505*sin(q1)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1)*cos(q2))*sin(q4) + 0.084*sin(q1)*sin(q3) - 0.105*sin(q1)*cos(q3) - 0.105*sin(q3)*cos(q1)*cos(q2) - 0.084*cos(q1)*cos(q2)*cos(q3))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.089095454429505*sin(q1)*sin(q3)*cos(q2) + 0.089095454429505*cos(q1)*cos(q3))*cos(q4) + 2*(0.089095454429505*sin(q1)*sin(q3)*cos(q2) - 0.089095454429505*cos(q1)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3)*cos(q2) - 0.084*sin(q1)*cos(q2)*cos(q3) - 0.084*sin(q3)*cos(q1) + 0.105*cos(q1)*cos(q3))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 
        dV4 =  ((-2*(-0.089095454429505*sin(q1)*sin(q3) + 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*sin(q4) + 2*(0.089095454429505*sin(q1)*sin(q3) - 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.17819090885901*sin(q2)*sin(q4)*cos(q1) + 0.17819090885901*sin(q2)*cos(q1)*cos(q4))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.089095454429505*sin(q1)*cos(q2)*cos(q3) - 0.089095454429505*sin(q3)*cos(q1))*cos(q4) - 2*(0.089095454429505*sin(q1)*cos(q2)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1))*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*sin(q4) + 0.17819090885901*sin(q1)*sin(q2)*cos(q4))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.089095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.089095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 
        
        return np.array([dV1,dV2,dV3,dV4,0,0,0],dtype='float')

    def  pointF_fun(self,r_joints_array,obs_x,obs_y):
        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]

        dV1 = ((2*(-0.152095454429505*sin(q1)*sin(q3) + 0.152095454429505*cos(q1)*cos(q2)*cos(q3))*cos(q4) + 2*(0.089095454429505*sin(q1)*sin(q3) - 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3) - 0.084*sin(q1)*cos(q3) + 0.30419090885901*sin(q2)*sin(q4)*cos(q1) + 0.17819090885901*sin(q2)*cos(q1)*cos(q4) + 0.586*sin(q2)*cos(q1) - 0.084*sin(q3)*cos(q1)*cos(q2) + 0.105*cos(q1)*cos(q2)*cos(q3))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2 + (2*(-0.152095454429505*sin(q1)*cos(q2)*cos(q3) - 0.152095454429505*sin(q3)*cos(q1))*cos(q4) + 2*(0.089095454429505*sin(q1)*cos(q2)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1))*sin(q4) - 0.30419090885901*sin(q1)*sin(q2)*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*cos(q4) - 0.586*sin(q1)*sin(q2) + 0.084*sin(q1)*sin(q3)*cos(q2) - 0.105*sin(q1)*cos(q2)*cos(q3) - 0.105*sin(q3)*cos(q1) - 0.084*cos(q1)*cos(q3))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 
        dV2 = ((0.084*sin(q1)*sin(q2)*sin(q3) + 0.17819090885901*sin(q1)*sin(q2)*sin(q4)*cos(q3) - 0.30419090885901*sin(q1)*sin(q2)*cos(q3)*cos(q4) - 0.105*sin(q1)*sin(q2)*cos(q3) + 0.30419090885901*sin(q1)*sin(q4)*cos(q2) + 0.17819090885901*sin(q1)*cos(q2)*cos(q4) + 0.586*sin(q1)*cos(q2))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2 + (0.084*sin(q2)*sin(q3)*cos(q1) + 0.17819090885901*sin(q2)*sin(q4)*cos(q1)*cos(q3) - 0.30419090885901*sin(q2)*cos(q1)*cos(q3)*cos(q4) - 0.105*sin(q2)*cos(q1)*cos(q3) + 0.30419090885901*sin(q4)*cos(q1)*cos(q2) + 0.17819090885901*cos(q1)*cos(q2)*cos(q4) + 0.586*cos(q1)*cos(q2))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 
        dV3 = ((2*(-0.152095454429505*sin(q1)*cos(q3) - 0.152095454429505*sin(q3)*cos(q1)*cos(q2))*cos(q4) + 2*(0.089095454429505*sin(q1)*cos(q3) + 0.089095454429505*sin(q3)*cos(q1)*cos(q2))*sin(q4) + 0.084*sin(q1)*sin(q3) - 0.105*sin(q1)*cos(q3) - 0.105*sin(q3)*cos(q1)*cos(q2) - 0.084*cos(q1)*cos(q2)*cos(q3))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.152095454429505*sin(q1)*sin(q3)*cos(q2) + 0.152095454429505*cos(q1)*cos(q3))*cos(q4) + 2*(0.089095454429505*sin(q1)*sin(q3)*cos(q2) - 0.089095454429505*cos(q1)*cos(q3))*sin(q4) - 0.105*sin(q1)*sin(q3)*cos(q2) - 0.084*sin(q1)*cos(q2)*cos(q3) - 0.084*sin(q3)*cos(q1) + 0.105*cos(q1)*cos(q3))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 
        dV4 = ((-2*(-0.152095454429505*sin(q1)*sin(q3) + 0.152095454429505*cos(q1)*cos(q2)*cos(q3))*sin(q4) + 2*(0.089095454429505*sin(q1)*sin(q3) - 0.089095454429505*cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.17819090885901*sin(q2)*sin(q4)*cos(q1) + 0.30419090885901*sin(q2)*cos(q1)*cos(q4))*(-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))/2 + (2*(-0.089095454429505*sin(q1)*cos(q2)*cos(q3) - 0.089095454429505*sin(q3)*cos(q1))*cos(q4) - 2*(0.152095454429505*sin(q1)*cos(q2)*cos(q3) + 0.152095454429505*sin(q3)*cos(q1))*sin(q4) - 0.17819090885901*sin(q1)*sin(q2)*sin(q4) + 0.30419090885901*sin(q1)*sin(q2)*cos(q4))*(-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))/2)/sqrt((-obs_x - 0.089095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*sin(q4) + 0.152095454429505*(-sin(q1)*sin(q3) + cos(q1)*cos(q2)*cos(q3))*cos(q4) - 0.0525*sin(q1)*sin(q3) - 0.042*sin(q1)*cos(q3) + 0.152095454429505*sin(q2)*sin(q4)*cos(q1) + 0.089095454429505*sin(q2)*cos(q1)*cos(q4) + 0.293*sin(q2)*cos(q1) - 0.042*sin(q3)*cos(q1)*cos(q2) + 0.0525*cos(q1)*cos(q2)*cos(q3))**2 + (-obs_y - 0.089095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q4) + 0.152095454429505*(sin(q1)*cos(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q4) + 0.152095454429505*sin(q1)*sin(q2)*sin(q4) + 0.089095454429505*sin(q1)*sin(q2)*cos(q4) + 0.293*sin(q1)*sin(q2) - 0.042*sin(q1)*sin(q3)*cos(q2) + 0.0525*sin(q1)*cos(q2)*cos(q3) + 0.0525*sin(q3)*cos(q1) + 0.042*cos(q1)*cos(q3))**2) 

        
        return np.array([dV1,dV2,dV3,dV4,0,0,0],dtype='float')




    def pointA_func(self, r_joints_array,ypos):

        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]


        d_V_q1=(0.045*(-1.95333333333333*np.sin(q1)*np.sin(q2) + 0.46*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.35*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1) - 0.46*np.cos(q1)*np.cos(q3))*(-0.175*np.sin(q1)*np.sin(q3) - 0.23*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.23*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-0.105*np.sin(q1)*np.sin(q3) - 0.138*np.sin(q1)*np.cos(q3) + 0.586*np.sin(q2)*np.cos(q1) - 0.138*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.105*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-ypos + 0.293*np.sin(q1)*np.sin(q2) - 0.069*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.069*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.293*np.sin(q1)*np.sin(q2) - 0.069*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.069*np.cos(q1)*np.cos(q3))**2 + 0.09*(-0.175*np.sin(q1)*np.sin(q3) - 0.23*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.23*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q2=((0.138*np.sin(q1)*np.sin(q2)*np.sin(q3) - 0.105*np.sin(q1)*np.sin(q2)*np.cos(q3) + 0.586*np.sin(q1)*np.cos(q2))*(-ypos + 0.293*np.sin(q1)*np.sin(q2) - 0.069*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.069*np.cos(q1)*np.cos(q3))/2 + 0.045*(0.46*np.sin(q2)*np.sin(q3)*np.cos(q1) - 0.35*np.sin(q2)*np.cos(q1)*np.cos(q3) + 1.95333333333333*np.cos(q1)*np.cos(q2))*(-0.175*np.sin(q1)*np.sin(q3) - 0.23*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.23*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.293*np.sin(q1)*np.sin(q2) - 0.069*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.069*np.cos(q1)*np.cos(q3))**2 + 0.09*(-0.175*np.sin(q1)*np.sin(q3) - 0.23*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.23*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q3=(0.045*(0.46*np.sin(q1)*np.sin(q3) - 0.35*np.sin(q1)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1)*np.cos(q2) - 0.46*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-0.175*np.sin(q1)*np.sin(q3) - 0.23*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.23*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-0.105*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.138*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.138*np.sin(q3)*np.cos(q1) + 0.105*np.cos(q1)*np.cos(q3))*(-ypos + 0.293*np.sin(q1)*np.sin(q2) - 0.069*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.069*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.293*np.sin(q1)*np.sin(q2) - 0.069*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.069*np.cos(q1)*np.cos(q3))**2 + 0.09*(-0.175*np.sin(q1)*np.sin(q3) - 0.23*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.23*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        return np.array([d_V_q1,d_V_q2,d_V_q3,0,0,0,0],dtype='float')

    def pointF_func(self, r_joints_array,ypos):

        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]


        d_V_q1=((2*(-0.0445477272147525*np.sin(q1)*np.sin(q3) + 0.0445477272147525*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.0445477272147525*np.sin(q1)*np.sin(q3) + 0.0445477272147525*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3) - 0.069*np.sin(q1)*np.cos(q3) + 0.089095454429505*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.089095454429505*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.586*np.sin(q2)*np.cos(q1) - 0.069*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.105*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))/2 + 0.045*(2*(-0.148492424049175*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(-0.148492424049175*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1))*np.cos(q4) - 0.29698484809835*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.29698484809835*np.sin(q1)*np.sin(q2)*np.cos(q4) - 1.95333333333333*np.sin(q1)*np.sin(q2) + 0.23*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.35*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1) - 0.23*np.cos(q1)*np.cos(q3))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q2=((0.069*np.sin(q1)*np.sin(q2)*np.sin(q3) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4)*np.cos(q3) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q3)*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q2)*np.cos(q3) + 0.089095454429505*np.sin(q1)*np.sin(q4)*np.cos(q2) - 0.089095454429505*np.sin(q1)*np.cos(q2)*np.cos(q4) + 0.586*np.sin(q1)*np.cos(q2))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))/2 + 0.045*(0.23*np.sin(q2)*np.sin(q3)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1)*np.cos(q3) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q3)*np.cos(q4) - 0.35*np.sin(q2)*np.cos(q1)*np.cos(q3) + 0.29698484809835*np.sin(q4)*np.cos(q1)*np.cos(q2) - 0.29698484809835*np.cos(q1)*np.cos(q2)*np.cos(q4) + 1.95333333333333*np.cos(q1)*np.cos(q2))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q3=(0.045*(2*(-0.148492424049175*np.sin(q1)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q4) + 2*(-0.148492424049175*np.sin(q1)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q4) + 0.23*np.sin(q1)*np.sin(q3) - 0.35*np.sin(q1)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1)*np.cos(q2) - 0.23*np.cos(q1)*np.cos(q2)*np.cos(q3))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (2*(-0.0445477272147525*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0445477272147525*np.cos(q1)*np.cos(q3))*np.sin(q4) + 2*(-0.0445477272147525*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0445477272147525*np.cos(q1)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.069*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.069*np.sin(q3)*np.cos(q1) + 0.105*np.cos(q1)*np.cos(q3))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q4=(0.045*(-2*(-0.148492424049175*np.sin(q1)*np.sin(q3) + 0.148492424049175*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.148492424049175*np.sin(q1)*np.sin(q3) + 0.148492424049175*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) + 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-2*(0.0445477272147525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0445477272147525*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(0.0445477272147525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0445477272147525*np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.0345*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.0345*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.115*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.115*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        return np.array([d_V_q1,d_V_q2,d_V_q3,d_V_q4,0,0,0],dtype='float')


    def pointB_func(self, r_joints_array,ypos):

        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]


        d_V_q1=(0.045*(-1.95333333333333*np.sin(q1)*np.sin(q2) - 0.712533333333333*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.35*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1) + 0.712533333333333*np.cos(q1)*np.cos(q3))*(-0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-0.105*np.sin(q1)*np.sin(q3) + 0.21376*np.sin(q1)*np.cos(q3) + 0.586*np.sin(q2)*np.cos(q1) + 0.21376*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.105*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-ypos + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(-0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q2=((-0.21376*np.sin(q1)*np.sin(q2)*np.sin(q3) - 0.105*np.sin(q1)*np.sin(q2)*np.cos(q3) + 0.586*np.sin(q1)*np.cos(q2))*(-ypos + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2 + 0.045*(-0.712533333333333*np.sin(q2)*np.sin(q3)*np.cos(q1) - 0.35*np.sin(q2)*np.cos(q1)*np.cos(q3) + 1.95333333333333*np.cos(q1)*np.cos(q2))*(-0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(-0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q3=(0.045*(-0.712533333333333*np.sin(q1)*np.sin(q3) - 0.35*np.sin(q1)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.712533333333333*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-0.105*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.21376*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.21376*np.sin(q3)*np.cos(q1) + 0.105*np.cos(q1)*np.cos(q3))*(-ypos + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(-0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        return np.array([d_V_q1,d_V_q2,d_V_q3,0,0,0,0],dtype='float')




    def pointD_func(self, r_joints_array,ypos):

        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]


        d_V_q1=((2*(-0.089095454429505*np.sin(q1)*np.sin(q3) + 0.089095454429505*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.089095454429505*np.sin(q1)*np.sin(q3) + 0.089095454429505*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3) + 0.21376*np.sin(q1)*np.cos(q3) + 0.17819090885901*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.17819090885901*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.586*np.sin(q2)*np.cos(q1) + 0.21376*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.105*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2 + 0.045*(2*(-0.29698484809835*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(-0.29698484809835*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1))*np.cos(q4) - 0.5939696961967*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.5939696961967*np.sin(q1)*np.sin(q2)*np.cos(q4) - 1.95333333333333*np.sin(q1)*np.sin(q2) - 0.712533333333333*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.35*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1) + 0.712533333333333*np.cos(q1)*np.cos(q3))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q2=((-0.21376*np.sin(q1)*np.sin(q2)*np.sin(q3) - 0.17819090885901*np.sin(q1)*np.sin(q2)*np.sin(q4)*np.cos(q3) - 0.17819090885901*np.sin(q1)*np.sin(q2)*np.cos(q3)*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q2)*np.cos(q3) + 0.17819090885901*np.sin(q1)*np.sin(q4)*np.cos(q2) - 0.17819090885901*np.sin(q1)*np.cos(q2)*np.cos(q4) + 0.586*np.sin(q1)*np.cos(q2))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2 + 0.045*(-0.712533333333333*np.sin(q2)*np.sin(q3)*np.cos(q1) - 0.5939696961967*np.sin(q2)*np.sin(q4)*np.cos(q1)*np.cos(q3) - 0.5939696961967*np.sin(q2)*np.cos(q1)*np.cos(q3)*np.cos(q4) - 0.35*np.sin(q2)*np.cos(q1)*np.cos(q3) + 0.5939696961967*np.sin(q4)*np.cos(q1)*np.cos(q2) - 0.5939696961967*np.cos(q1)*np.cos(q2)*np.cos(q4) + 1.95333333333333*np.cos(q1)*np.cos(q2))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q3=(0.045*(2*(-0.29698484809835*np.sin(q1)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q4) + 2*(-0.29698484809835*np.sin(q1)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q4) - 0.712533333333333*np.sin(q1)*np.sin(q3) - 0.35*np.sin(q1)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.712533333333333*np.cos(q1)*np.cos(q2)*np.cos(q3))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (2*(-0.089095454429505*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.089095454429505*np.cos(q1)*np.cos(q3))*np.sin(q4) + 2*(-0.089095454429505*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.089095454429505*np.cos(q1)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.21376*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.21376*np.sin(q3)*np.cos(q1) + 0.105*np.cos(q1)*np.cos(q3))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)
        d_V_q4=(0.045*(-2*(-0.29698484809835*np.sin(q1)*np.sin(q3) + 0.29698484809835*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.29698484809835*np.sin(q1)*np.sin(q3) + 0.29698484809835*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + 0.5939696961967*np.sin(q2)*np.sin(q4)*np.cos(q1) + 0.5939696961967*np.sin(q2)*np.cos(q1)*np.cos(q4))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-2*(0.089095454429505*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.089095454429505*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(0.089095454429505*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.089095454429505*np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.17819090885901*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.17819090885901*np.sin(q1)*np.sin(q2)*np.cos(q4))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        return np.array([d_V_q1,d_V_q2,d_V_q3,d_V_q4,0,0,0],dtype='float')

    def pointC_func(self, r_joints_array,ypos):

        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]


        d_V_q1=((2*(-0.0445477272147525*np.sin(q1)*np.sin(q3) + 0.0445477272147525*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.0445477272147525*np.sin(q1)*np.sin(q3) + 0.0445477272147525*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3) + 0.21376*np.sin(q1)*np.cos(q3) + 0.089095454429505*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.089095454429505*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.586*np.sin(q2)*np.cos(q1) + 0.21376*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.105*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2 + 0.045*(2*(-0.148492424049175*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(-0.148492424049175*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1))*np.cos(q4) - 0.29698484809835*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.29698484809835*np.sin(q1)*np.sin(q2)*np.cos(q4) - 1.95333333333333*np.sin(q1)*np.sin(q2) - 0.712533333333333*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.35*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1) + 0.712533333333333*np.cos(q1)*np.cos(q3))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q2=((-0.21376*np.sin(q1)*np.sin(q2)*np.sin(q3) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4)*np.cos(q3) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q3)*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q2)*np.cos(q3) + 0.089095454429505*np.sin(q1)*np.sin(q4)*np.cos(q2) - 0.089095454429505*np.sin(q1)*np.cos(q2)*np.cos(q4) + 0.586*np.sin(q1)*np.cos(q2))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2 + 0.045*(-0.712533333333333*np.sin(q2)*np.sin(q3)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1)*np.cos(q3) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q3)*np.cos(q4) - 0.35*np.sin(q2)*np.cos(q1)*np.cos(q3) + 0.29698484809835*np.sin(q4)*np.cos(q1)*np.cos(q2) - 0.29698484809835*np.cos(q1)*np.cos(q2)*np.cos(q4) + 1.95333333333333*np.cos(q1)*np.cos(q2))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q3=(0.045*(2*(-0.148492424049175*np.sin(q1)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q4) + 2*(-0.148492424049175*np.sin(q1)*np.cos(q3) - 0.148492424049175*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q4) - 0.712533333333333*np.sin(q1)*np.sin(q3) - 0.35*np.sin(q1)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.712533333333333*np.cos(q1)*np.cos(q2)*np.cos(q3))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (2*(-0.0445477272147525*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0445477272147525*np.cos(q1)*np.cos(q3))*np.sin(q4) + 2*(-0.0445477272147525*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0445477272147525*np.cos(q1)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.21376*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.21376*np.sin(q3)*np.cos(q1) + 0.105*np.cos(q1)*np.cos(q3))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q4=(0.045*(-2*(-0.148492424049175*np.sin(q1)*np.sin(q3) + 0.148492424049175*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.148492424049175*np.sin(q1)*np.sin(q3) + 0.148492424049175*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) + 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4))*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-2*(0.0445477272147525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0445477272147525*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(0.0445477272147525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0445477272147525*np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4))*(-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.0445477272147525*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.0445477272147525*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) + 0.10688*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) - 0.10688*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.148492424049175*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) + 0.356266666666667*np.sin(q1)*np.cos(q3) + 0.148492424049175*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.148492424049175*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) + 0.356266666666667*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        return np.array([d_V_q1,d_V_q2,d_V_q3,d_V_q4,0,0,0],dtype='float')


    def pointE_func(self, r_joints_array,ypos):

        q1=r_joints_array[0]
        q2=r_joints_array[1]
        q3=r_joints_array[2]
        q4=r_joints_array[3]
        q5=r_joints_array[4]
        q6=r_joints_array[5]
        q7=r_joints_array[6]


        d_V_q1=((2*(-0.089095454429505*np.sin(q1)*np.sin(q3) + 0.089095454429505*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.089095454429505*np.sin(q1)*np.sin(q3) + 0.089095454429505*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3) - 0.084*np.sin(q1)*np.cos(q3) + 0.17819090885901*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.17819090885901*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.586*np.sin(q2)*np.cos(q1) - 0.084*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.105*np.cos(q1)*np.cos(q2)*np.cos(q3))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))/2 + 0.045*(2*(-0.29698484809835*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(-0.29698484809835*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1))*np.cos(q4) - 0.5939696961967*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.5939696961967*np.sin(q1)*np.sin(q2)*np.cos(q4) - 1.95333333333333*np.sin(q1)*np.sin(q2) + 0.28*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.35*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1) - 0.28*np.cos(q1)*np.cos(q3))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q2=((0.084*np.sin(q1)*np.sin(q2)*np.sin(q3) - 0.17819090885901*np.sin(q1)*np.sin(q2)*np.sin(q4)*np.cos(q3) - 0.17819090885901*np.sin(q1)*np.sin(q2)*np.cos(q3)*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q2)*np.cos(q3) + 0.17819090885901*np.sin(q1)*np.sin(q4)*np.cos(q2) - 0.17819090885901*np.sin(q1)*np.cos(q2)*np.cos(q4) + 0.586*np.sin(q1)*np.cos(q2))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))/2 + 0.045*(0.28*np.sin(q2)*np.sin(q3)*np.cos(q1) - 0.5939696961967*np.sin(q2)*np.sin(q4)*np.cos(q1)*np.cos(q3) - 0.5939696961967*np.sin(q2)*np.cos(q1)*np.cos(q3)*np.cos(q4) - 0.35*np.sin(q2)*np.cos(q1)*np.cos(q3) + 0.5939696961967*np.sin(q4)*np.cos(q1)*np.cos(q2) - 0.5939696961967*np.cos(q1)*np.cos(q2)*np.cos(q4) + 1.95333333333333*np.cos(q1)*np.cos(q2))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1))/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q3=(0.045*(2*(-0.29698484809835*np.sin(q1)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.sin(q4) + 2*(-0.29698484809835*np.sin(q1)*np.cos(q3) - 0.29698484809835*np.sin(q3)*np.cos(q1)*np.cos(q2))*np.cos(q4) + 0.28*np.sin(q1)*np.sin(q3) - 0.35*np.sin(q1)*np.cos(q3) - 0.35*np.sin(q3)*np.cos(q1)*np.cos(q2) - 0.28*np.cos(q1)*np.cos(q2)*np.cos(q3))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (2*(-0.089095454429505*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.089095454429505*np.cos(q1)*np.cos(q3))*np.sin(q4) + 2*(-0.089095454429505*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.089095454429505*np.cos(q1)*np.cos(q3))*np.cos(q4) - 0.105*np.sin(q1)*np.sin(q3)*np.cos(q2) - 0.084*np.sin(q1)*np.cos(q2)*np.cos(q3) - 0.084*np.sin(q3)*np.cos(q1) + 0.105*np.cos(q1)*np.cos(q3))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        d_V_q4=(0.045*(-2*(-0.29698484809835*np.sin(q1)*np.sin(q3) + 0.29698484809835*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 2*(-0.29698484809835*np.sin(q1)*np.sin(q3) + 0.29698484809835*np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) + 0.5939696961967*np.sin(q2)*np.sin(q4)*np.cos(q1) + 0.5939696961967*np.sin(q2)*np.cos(q1)*np.cos(q4))*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1) + (-2*(0.089095454429505*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.089095454429505*np.sin(q3)*np.cos(q1))*np.sin(q4) + 2*(0.089095454429505*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.089095454429505*np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.17819090885901*np.sin(q1)*np.sin(q2)*np.sin(q4) + 0.17819090885901*np.sin(q1)*np.sin(q2)*np.cos(q4))*(-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))/2)/np.sqrt((-ypos + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.sin(q4) + 0.089095454429505*(np.sin(q1)*np.cos(q2)*np.cos(q3) + np.sin(q3)*np.cos(q1))*np.cos(q4) + 0.089095454429505*np.sin(q1)*np.sin(q2)*np.sin(q4) - 0.089095454429505*np.sin(q1)*np.sin(q2)*np.cos(q4) + 0.293*np.sin(q1)*np.sin(q2) - 0.042*np.sin(q1)*np.sin(q3)*np.cos(q2) + 0.0525*np.sin(q1)*np.cos(q2)*np.cos(q3) + 0.0525*np.sin(q3)*np.cos(q1) + 0.042*np.cos(q1)*np.cos(q3))**2 + 0.09*(0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.sin(q4) + 0.29698484809835*(-np.sin(q1)*np.sin(q3) + np.cos(q1)*np.cos(q2)*np.cos(q3))*np.cos(q4) - 0.175*np.sin(q1)*np.sin(q3) - 0.14*np.sin(q1)*np.cos(q3) + 0.29698484809835*np.sin(q2)*np.sin(q4)*np.cos(q1) - 0.29698484809835*np.sin(q2)*np.cos(q1)*np.cos(q4) + 0.976666666666667*np.sin(q2)*np.cos(q1) - 0.14*np.sin(q3)*np.cos(q1)*np.cos(q2) + 0.175*np.cos(q1)*np.cos(q2)*np.cos(q3) - 1)**2)

        return np.array([d_V_q1,d_V_q2,d_V_q3,d_V_q4,0,0,0],dtype='float')